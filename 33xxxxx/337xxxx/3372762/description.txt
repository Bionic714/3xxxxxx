FINALLY IT'S WORKING (TESTED!!!)