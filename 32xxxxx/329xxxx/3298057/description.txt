Working version of the editor. Enjoy...