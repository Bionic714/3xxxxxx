recoded from the CRiMSON to correct a windoze explorer crash fault.